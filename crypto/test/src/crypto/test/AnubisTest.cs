using System;

using NUnit.Framework;

using Org.BouncyCastle.Crypto.Engines;
using Org.BouncyCastle.Crypto.Parameters;
using Org.BouncyCastle.Utilities.Encoders;
using Org.BouncyCastle.Utilities.Test;

namespace Org.BouncyCastle.Crypto.Tests
{
    /// <summary> Test vectors from the Anubis page
    /// <a href="https://web.archive.org/web/20110706163044/http://www.larc.usp.br/~pbarreto/AnubisPage.html">
    /// https://web.archive.org/web/20110706163044/http://www.larc.usp.br/~pbarreto/AnubisPage.html</a>
    /// </summary>
    [TestFixture]
    public class AnubisTest : CipherTest
    {
        internal static SimpleTest[] tests = new SimpleTest[]{
            // original 128-bit key
            new BlockCipherVectorTest(0, new AnubisEngine(false), new KeyParameter(Hex.Decode("80000000000000000000000000000000")), "00000000000000000000000000000000", "F06860FC6730E818F132C78AF4132AFE"),
            new BlockCipherVectorTest(1, new AnubisEngine(false), new KeyParameter(Hex.Decode("00000000000000000000000000000001")), "00000000000000000000000000000000", "A866848007745C89FC5EB5BAD4FE326D"),
            new BlockCipherVectorTest(2, new AnubisEngine(false), new KeyParameter(Hex.Decode("00000000000000000000000000000000")), "00002000000000000000000000000000", "0D2A223BDF76B61029C3C3A4A72E364F"),
            new BlockCipherMonteCarloTest(3, 1000, new AnubisEngine(false), new KeyParameter(Hex.Decode("01010101010101010101010101010101")), "01010101010101010101010101010101", "D64394E88C2B445407FBC3D4DB588C14"),
            new BlockCipherMonteCarloTest(4, 1000, new AnubisEngine(false), new KeyParameter(Hex.Decode("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF")), "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "EBDE86CC68308A7276ABA67E2C8782F5"),
            
            // original 160-bit key
            new BlockCipherVectorTest(5, new AnubisEngine(false), new KeyParameter(Hex.Decode("8000000000000000000000000000000000000000")), "00000000000000000000000000000000", "BD5E32BE5167A8E272D7950F83C68C31"),
            new BlockCipherVectorTest(6, new AnubisEngine(false), new KeyParameter(Hex.Decode("0000000000000000000000000000000000000001")), "00000000000000000000000000000000", "4C1F862E11EBCEEBFEB973C9DFEF7ADB"),
            new BlockCipherVectorTest(7, new AnubisEngine(false), new KeyParameter(Hex.Decode("0000000000000000000000000000000000000000")), "08000000000000000000000000000000", "ABF31F362CEB8B070357ADBA5396A361"),
            new BlockCipherMonteCarloTest(8, 1000, new AnubisEngine(false), new KeyParameter(Hex.Decode("0202020202020202020202020202020202020202")), "02020202020202020202020202020202", "D4A7F3B370F5EDDB809F80B8B47C185E"),
            new BlockCipherMonteCarloTest(9, 1000, new AnubisEngine(false), new KeyParameter(Hex.Decode("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF")), "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "43F088A1FE8E4AC52C8CAFAF0147B74B"),
            
            // original 192-bit key
            new BlockCipherVectorTest(10, new AnubisEngine(false), new KeyParameter(Hex.Decode("800000000000000000000000000000000000000000000000")), "00000000000000000000000000000000", "17AC57449D596166D0C79E047CC758F0"),
            new BlockCipherVectorTest(11, new AnubisEngine(false), new KeyParameter(Hex.Decode("000000000000000000000000000000000000000000000001")), "00000000000000000000000000000000", "7152B4EB1DAA36FD57145F57049F7074"),
            new BlockCipherVectorTest(12, new AnubisEngine(false), new KeyParameter(Hex.Decode("000000000000000000000000000000000000000000000000")), "00000040000000000000000000000000", "F520671672026AE069D77A956F9682CA"),
            new BlockCipherMonteCarloTest(13, 1000, new AnubisEngine(false), new KeyParameter(Hex.Decode("020202020202020202020202020202020202020202020202")), "02020202020202020202020202020202", "EFE787A370975017787EA1E8D22CE841"),
            new BlockCipherMonteCarloTest(14, 1000, new AnubisEngine(false), new KeyParameter(Hex.Decode("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF")), "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "B1ED0EC32DECC9EEBDF499F2D65FCF57"),
            
            // original 224-bit key
            new BlockCipherVectorTest(15, new AnubisEngine(false), new KeyParameter(Hex.Decode("80000000000000000000000000000000000000000000000000000000")), "00000000000000000000000000000000", "A2F0A6B917932A3BEF08E87A58D6F853"),
            new BlockCipherVectorTest(16, new AnubisEngine(false), new KeyParameter(Hex.Decode("00000000000000000000000000000000000000000000000000000001")), "00000000000000000000000000000000", "F0CAFC788B4B4E538BC4326AF5B91B5F"),
            new BlockCipherVectorTest(17, new AnubisEngine(false), new KeyParameter(Hex.Decode("00000000000000000000000000000000000000000000000000000000")), "00000040000000000000000000000000", "A7524A0F9F62386BBFDAFC0F3BA30BF8"),
            new BlockCipherMonteCarloTest(18, 1000, new AnubisEngine(false), new KeyParameter(Hex.Decode("03030303030303030303030303030303030303030303030303030303")), "03030303030303030303030303030303", "DF5C5C86180AB920C0DB858C524C526A"),
            new BlockCipherMonteCarloTest(19, 1000, new AnubisEngine(false), new KeyParameter(Hex.Decode("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF")), "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "C9E01319C74002A9A66A25BDDE5332BA"),
            
            // original 256-bit key
            new BlockCipherVectorTest(20, new AnubisEngine(false), new KeyParameter(Hex.Decode("8000000000000000000000000000000000000000000000000000000000000000")), "00000000000000000000000000000000", "E086AC456B3CE513EDF5DFDDD63B7193"),
            new BlockCipherVectorTest(21, new AnubisEngine(false), new KeyParameter(Hex.Decode("0000000000000000000000000000000000000000000000000000000000000001")), "00000000000000000000000000000000", "5001B9F521C1C12900D5EC982B9EE821"),
            new BlockCipherVectorTest(22, new AnubisEngine(false), new KeyParameter(Hex.Decode("0000000000000000000000000000000000000000000000000000000000000000")), "00000040000000000000000000000000", "4503AB1725E2297860CABDBF4C394692"),
            new BlockCipherMonteCarloTest(23, 1000, new AnubisEngine(false), new KeyParameter(Hex.Decode("0404040404040404040404040404040404040404040404040404040404040404")), "04040404040404040404040404040404", "9E4D164F3AD58CEF00BE9A379F3C8541"),
            new BlockCipherMonteCarloTest(24, 1000, new AnubisEngine(false), new KeyParameter(Hex.Decode("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF")), "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "33AAA7BFA94094614165A9824B3DCE98"),
            
            // original 288-bit key
            new BlockCipherVectorTest(25, new AnubisEngine(false), new KeyParameter(Hex.Decode("800000000000000000000000000000000000000000000000000000000000000000000000")), "00000000000000000000000000000000", "E8F4AF2B21A0879B4195B9717579047C"),
            new BlockCipherVectorTest(26, new AnubisEngine(false), new KeyParameter(Hex.Decode("000000000000000000000000000000000000000000000000000000000000000000000001")), "00000000000000000000000000000000", "E6A6A5BC8B636FE2BDA7A753AB4022E0"),
            new BlockCipherVectorTest(27, new AnubisEngine(false), new KeyParameter(Hex.Decode("000000000000000000000000000000000000000000000000000000000000000000000000")), "00000040000000000000000000000000", "060BFD8935F1A99B45981321FEDF6122"),
            new BlockCipherMonteCarloTest(28, 1000, new AnubisEngine(false), new KeyParameter(Hex.Decode("050505050505050505050505050505050505050505050505050505050505050505050505")), "05050505050505050505050505050505", "02B6E591A8C94FDE6908960FCC725B78"),
            new BlockCipherMonteCarloTest(29, 1000, new AnubisEngine(false), new KeyParameter(Hex.Decode("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF")), "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "C8DBC1AC75552F64A0FDD6AE75884131"),
            
            // original 320-bit key
            new BlockCipherVectorTest(30, new AnubisEngine(false), new KeyParameter(Hex.Decode("80000000000000000000000000000000000000000000000000000000000000000000000000000000")), "00000000000000000000000000000000", "1704D72CC68576024BCC3980D822EAA4"),
            new BlockCipherVectorTest(31, new AnubisEngine(false), new KeyParameter(Hex.Decode("00000000000000000000000000000000000000000000000000000000000000000000000000000001")), "00000000000000000000000000000000", "7A41E67D4FD864F044A83C73817E53D8"),
            new BlockCipherVectorTest(32, new AnubisEngine(false), new KeyParameter(Hex.Decode("00000000000000000000000000000000000000000000000000000000000000000000000000000000")), "00000040000000000000000000000000", "B77EE2BFEEFC03C8DB8A38710A0F17B6"),
            new BlockCipherMonteCarloTest(33, 1000, new AnubisEngine(false), new KeyParameter(Hex.Decode("06060606060606060606060606060606060606060606060606060606060606060606060606060606")), "06060606060606060606060606060606", "89F3EB6684C6A7D50738BDA53EB09D26"),
            new BlockCipherMonteCarloTest(34, 1000, new AnubisEngine(false), new KeyParameter(Hex.Decode("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF")), "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "18A34EB875E196727919418FB8540967"),
            

            // tweaked 128-bit key
            new BlockCipherVectorTest(35, new AnubisEngine(true), new KeyParameter(Hex.Decode("80000000000000000000000000000000")), "00000000000000000000000000000000", "B835BDC334829D8371BFA371E4B3C4FD"),
            new BlockCipherVectorTest(36, new AnubisEngine(true), new KeyParameter(Hex.Decode("00000000000000000000000000000001")), "00000000000000000000000000000000", "E6141EAFEBE0593C48E1CDF21BBAA189"),
            new BlockCipherVectorTest(37, new AnubisEngine(true), new KeyParameter(Hex.Decode("00000000000000000000000000000000")), "00002000000000000000000000000000", "E0D5FD6C8EFC1CFE17819DA6010E8BCD"),
            new BlockCipherMonteCarloTest(38, 1000, new AnubisEngine(true), new KeyParameter(Hex.Decode("01010101010101010101010101010101")), "01010101010101010101010101010101", "8C0A6F8255C005ED91AD08406C61C367"),
            new BlockCipherMonteCarloTest(39, 1000, new AnubisEngine(true), new KeyParameter(Hex.Decode("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF")), "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "D58CACBA4FB8499A67F8C7DD13B97429"),
            
            // tweaked 160-bit key
            new BlockCipherVectorTest(40, new AnubisEngine(true), new KeyParameter(Hex.Decode("8000000000000000000000000000000000000000")), "00000000000000000000000000000000", "9759794B5CA0707324EFB35867CAD4B3"),
            new BlockCipherVectorTest(41, new AnubisEngine(true), new KeyParameter(Hex.Decode("0000000000000000000000000000000000000001")), "00000000000000000000000000000000", "B80DFB9BE4A15887B376D5021895C12E"),
            new BlockCipherVectorTest(42, new AnubisEngine(true), new KeyParameter(Hex.Decode("0000000000000000000000000000000000000000")), "08000000000000000000000000000000", "11A07ACABDBF29A06E3A9F080B77B1F5"),
            new BlockCipherMonteCarloTest(43, 1000, new AnubisEngine(true), new KeyParameter(Hex.Decode("0202020202020202020202020202020202020202")), "02020202020202020202020202020202", "3F76D732983E0092AC446F1B16C84EBB"),
            new BlockCipherMonteCarloTest(44, 1000, new AnubisEngine(true), new KeyParameter(Hex.Decode("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF")), "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "47C12314BF9FEC1276A6A2536F35D213"),
            
            // tweaked 192-bit key
            new BlockCipherVectorTest(45, new AnubisEngine(true), new KeyParameter(Hex.Decode("800000000000000000000000000000000000000000000000")), "00000000000000000000000000000000", "7D623B52C74C64D8EBC72D579785438F"),
            new BlockCipherVectorTest(46, new AnubisEngine(true), new KeyParameter(Hex.Decode("000000000000000000000000000000000000000000000001")), "00000000000000000000000000000000", "B10A59DD5D5D8D67ECEE4AC4BE4FA84F"),
            new BlockCipherVectorTest(47, new AnubisEngine(true), new KeyParameter(Hex.Decode("000000000000000000000000000000000000000000000000")), "00000040000000000000000000000000", "A8D627B2243C89648C3488276EC7E8F4"),
            new BlockCipherMonteCarloTest(48, 1000, new AnubisEngine(true), new KeyParameter(Hex.Decode("020202020202020202020202020202020202020202020202")), "02020202020202020202020202020202", "72387FC8F2548A8CCEF06FA776C87D60"),
            new BlockCipherMonteCarloTest(49, 1000, new AnubisEngine(true), new KeyParameter(Hex.Decode("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF")), "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "33EEF7CDA63DCAFC40DAA81C91C77598"),
            
            // tweaked 224-bit key
            new BlockCipherVectorTest(50, new AnubisEngine(true), new KeyParameter(Hex.Decode("80000000000000000000000000000000000000000000000000000000")), "00000000000000000000000000000000", "689E05946A94438FE78E373D249792F5"),
            new BlockCipherVectorTest(51, new AnubisEngine(true), new KeyParameter(Hex.Decode("00000000000000000000000000000000000000000000000000000001")), "00000000000000000000000000000000", "DDB7B0B4E9B49B9C3820250B47C21F89"),
            new BlockCipherVectorTest(52, new AnubisEngine(true), new KeyParameter(Hex.Decode("00000000000000000000000000000000000000000000000000000000")), "00000040000000000000000000000000", "F18A0E8CB6836C2629F7AED843B340ED"),
            new BlockCipherMonteCarloTest(53, 1000, new AnubisEngine(true), new KeyParameter(Hex.Decode("03030303030303030303030303030303030303030303030303030303")), "03030303030303030303030303030303", "F69A2EA6CA33AC31ACB624DF1B30D2B0"),
            new BlockCipherMonteCarloTest(54, 1000, new AnubisEngine(true), new KeyParameter(Hex.Decode("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF")), "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "5C4C45A8D065254A9B1E6D24DD94867F"),
            
            // tweaked 256-bit key
            new BlockCipherVectorTest(55, new AnubisEngine(true), new KeyParameter(Hex.Decode("8000000000000000000000000000000000000000000000000000000000000000")), "00000000000000000000000000000000", "9600F07691692987F5E597DBDBAF1B0A"),
            new BlockCipherVectorTest(56, new AnubisEngine(true), new KeyParameter(Hex.Decode("0000000000000000000000000000000000000000000000000000000000000001")), "00000000000000000000000000000000", "699CAFDD94C7BC6044FE02058A6EEFBD"),
            new BlockCipherVectorTest(57, new AnubisEngine(true), new KeyParameter(Hex.Decode("0000000000000000000000000000000000000000000000000000000000000000")), "00000040000000000000000000000000", "206919B913D7F28041DC4398B764F2E8"),
            new BlockCipherMonteCarloTest(58, 1000, new AnubisEngine(true), new KeyParameter(Hex.Decode("0404040404040404040404040404040404040404040404040404040404040404")), "04040404040404040404040404040404", "650698D33A6E68853B78478960B74360"),
            new BlockCipherMonteCarloTest(59, 1000, new AnubisEngine(true), new KeyParameter(Hex.Decode("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF")), "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "55317E05B00DFEA707BA261F1C018BA4"),
            
            // tweaked 288-bit key
            new BlockCipherVectorTest(60, new AnubisEngine(true), new KeyParameter(Hex.Decode("800000000000000000000000000000000000000000000000000000000000000000000000")), "00000000000000000000000000000000", "0FC7A2C01117AC43525EDF6CF396336C"),
            new BlockCipherVectorTest(61, new AnubisEngine(true), new KeyParameter(Hex.Decode("000000000000000000000000000000000000000000000000000000000000000000000001")), "00000000000000000000000000000000", "AD084FED55A6943E7E5EED05A19D41B4"),
            new BlockCipherVectorTest(62, new AnubisEngine(true), new KeyParameter(Hex.Decode("000000000000000000000000000000000000000000000000000000000000000000000000")), "00000040000000000000000000000000", "33A050BF3B2588B068B597141AE165B7"),
            new BlockCipherMonteCarloTest(63, 1000, new AnubisEngine(true), new KeyParameter(Hex.Decode("050505050505050505050505050505050505050505050505050505050505050505050505")), "05050505050505050505050505050505", "06473A9A0AE0B73062A3E02FCD1C23DF"),
            new BlockCipherMonteCarloTest(64, 1000, new AnubisEngine(true), new KeyParameter(Hex.Decode("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF")), "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "CBB41074942707CBBFDBF97EC0452F94"),
            
            // tweaked 320-bit key
            new BlockCipherVectorTest(65, new AnubisEngine(true), new KeyParameter(Hex.Decode("80000000000000000000000000000000000000000000000000000000000000000000000000000000")), "00000000000000000000000000000000", "FEE20E2A9DC583BAA3A6D6A6F2E806A5"),
            new BlockCipherVectorTest(66, new AnubisEngine(true), new KeyParameter(Hex.Decode("00000000000000000000000000000000000000000000000000000000000000000000000000000001")), "00000000000000000000000000000000", "863DCC4A60349C28A7DAA43B0AD7FDC7"),
            new BlockCipherVectorTest(67, new AnubisEngine(true), new KeyParameter(Hex.Decode("00000000000000000000000000000000000000000000000000000000000000000000000000000000")), "00000040000000000000000000000000", "ACF7151F51BE8F730363F57C81030E50"),
            new BlockCipherMonteCarloTest(68, 1000, new AnubisEngine(true), new KeyParameter(Hex.Decode("06060606060606060606060606060606060606060606060606060606060606060606060606060606")), "06060606060606060606060606060606", "FCE47BAA9ABB2A29E8AA6F2A8AB958DD"),
            new BlockCipherMonteCarloTest(69, 1000, new AnubisEngine(true), new KeyParameter(Hex.Decode("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF")), "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "826BE24DE86F7DB86A5508590C2D8C37")
        };

        public override string Name { get { return "Anubis"; } }

        public AnubisTest()
            : base(tests, new AnubisEngine(), new KeyParameter(new byte[16]))
        {
        }

        public override ITestResult Perform()
        {
            ITestResult result = base.Perform();
            if (!result.IsSuccessful())
            {
                return result;
            }

            return new SimpleTestResult(true, Name + ": Okay");
        }

        public static void Main(
            string[] args)
        {
            AnubisTest test = new AnubisTest();
            ITestResult result = test.Perform();

            Console.WriteLine(result);
        }

        [Test]
        public void TestFunction()
        {
            string resultText = Perform().ToString();

            Assert.AreEqual(Name + ": Okay", resultText);
        }
    }
}
